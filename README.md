# LARVIS Poker
This project provides an image uploader service for receipt scanning, enabling users to upload photos of their receipts, store them in different resolutions, and download them in an appropriate size. The service functions using a REST API and stores images in the local filesystem.


## Quick start:
Clone the repository:

```bash

git clone https://github.com/yourusername/receipt-uploader.git
cd receipt-uploader

go mod download

go run main.go
```

## System design and specifications
- Uploading of receipt 
  - Handled by request of `POST /receipts`
  - Each request has 2 attributes in header: access_token and transcationID (automatically generated by payment processor, i.e, bank, Visa)
  - System does not check the content of uploaded receipts
  - Only `.jpg` file is supported
  - No duplicate receipts are stored in system: uploading differernt receipts with the same transcationID will overwrite previous ones
  - Receipts of each user are stored in `receipts/username` folder
  - Sub-folders are created within usernmae folder with name of `transcationID` and images are stored there with names of small, medium, large (original size).
  - Example strcuture of `receipts` folder: `receipts/user1/transcationID_1/small.jpg`, `receipts/user1/transcationID_1/medium.jpg`, `receipts/user1/transcationID_1/large.jpg`
- Downloading of receipt 
  - Handled by request of `GET /api/receipts/{receiptId}?resolution=small|medium|large`
  - Each request must have 1 attribute in header: access_token
  - If resolution is not provided, default value `resolution=small` is used 
  - To facilitate locating image, receiptId is composed as 


## Data validatation:


## Image Resizing:
Images will be resized to fit standard resolutions:
- Small (e.g., 640x480)
- Medium (e.g., 1280x720)
- Large (e.g., 1920x1080)
The images will be proportionally scaled according to their original dimensions to maintain aspect ratio.

## Image storage:
- Images of the same receipt are stored within a folder named by username, each image if suffixed by either small, medium, large (original size)
- System checks dulicate uploads of the same receipt by checking the name of uploaded image from client



## API endpoints:

`POST /api/receipts`

Request Body:
```bash
{
  "userId": "string",  // optional for permissions system
  "image": "file"      // binary file upload of the receipt image
}
```
Response:
```bash
{
    "message": "Receipt uploaded successfully",
    "receiptId": "string",
    "imageUrl": "string" // URL to access the uploaded image
}
```

400 Bad Request: Invalid image format
```bash
{
    "error": "Invalid image format"
}
```

500 Internal Server Error: Unexpected error
```bash
{
    "error": "An unexpected error occurred"
}
```

`GET /api/receipts/{receiptId}?resolution=small|medium|large`
Response:
200 OK: Retrieved successfully, returns the image with the specified or default resolution. If query parameter `resolution` is not specified, default value `small` is used

404 Not Found: Receipt does not exist
```bash
{
    "error": "Receipt not found"
}
```

403 Forbidden: User does not have permission to access this receipt (if permissions system is implemented)
```bash
{
    "error": "Access denied"
}
```
## Stretch
- assume each upload of receipt has a transcationID
- assume there is access_token in upload and download

## Testing

## Project structure

## Concerons
- Encryption when uploading image
